<!DOCTYPE html>
<html>

<head>
  <title>ODS Widgets Minimal Boilerplate</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <!-- These are  the required CSS files if you use ODS widgets -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://opendatasoft.github.io/ods-widgets/dist/ods-widgets.css">
</head>

<body>
  <div class="container-fluid" ng-app="ods-widgets">
    <ods-dataset-context context="velo" velo-domain="data.opendatasoft.com" velo-dataset="amenagements-velo-en-ile-de-france@datailedefrance">
      <section id="intro">
        <div class="prose">
          <h1>Opendatasotf scrollytelling boilerplate</h1>
          <p>This a little boilerplate that showcases different techniques of scrolly telling you can use with our data. We have more than 20k
            ,000 dataset you can use to tell data driven stories!</p>
          <p>This boilerplate uses the most excellent scrollama lib and takes a lot of inspiration from the Mapbox GL JS scrollytelling template. Be sure to check those out!</p>
        </div>
      </section>
      <section id="fullsrceen">
        <div id="fullscreen">
          <!-- The .step div takes the full screen, inside it you want to place your text etc. which is typically not fullscreen -->
          <map id="map-idf" class="ods-map-wrapper">
            <ods-map class="fullscreen-feature" location="10,48.831,2.349" scroll-wheel-zoom="false" display-control="0">
              <ods-map-layer context="velo" color="#128317"></ods-map-layer>
            </ods-map>
          </map>
          <div class="step" data-feature="map-idf">
            <div class="story-block lefty">
              <p>This a map from ODS widgets. It will have
                <pre>position:Â fixed;</pre> until this box is out. It uses the default action of this boilerplate:Â add the
                <pre>.active</pre> class to the feature.</p>
            </div>
          </div>
          <figure id="chart-idf" class="ods-chart-wrapper">
            <ods-chart class="fullscreen-feature" align-month="true">
              <ods-chart-query context="velo" field-x="highway" maxpoints="50">
                <ods-chart-serie expression-y="osm_id" chart-type="column" function-y="AVG" color="#e74c3c" scientific-display="true">
                </ods-chart-serie>
              </ods-chart-query>
            </ods-chart>
          </figure>
          <div class="step" data-feature="chart-idf">
            <div class="story-block centered">
              <p>Sticky is the most common behavior in scrollytelling, but you can add any transition you want. This chart from ODS widgets, slides in and fades. To do that you have to specify callbacks when entering and exiting the step in the
                callback mapping of
                <pre>src/app.js</pre>
              </p>
              <p>You can also style those text box as you wish! Here we centered it ðŸ˜„</p>
            </div>
          </div>
        </div>
      </section>
    </ods-dataset-context>
    <section id="external-libs">
      <div class="prose">
        <h2>External libs</h2>
        <p>You are not limited to ODS widgets either. You can fetch the data with our API and then include it in your favorite JS libs, like mapbox GL JS, Highcharts etc.</p>
      </div>
    </section>
    <section id="ods-api">
      <div class="scrolly-side">
        <div class="step" data-feature="api-progress">
          <div class="story-block lefty">
            <p>To make an API call, just get the URL of the dataset, form your query and do a <code>fetch</code> with your query. With the ODS api you can filter and aggregate direcly in the query with an SQL like syntax.</p>
            <a href="https://help.opendatasoft.com/apis/ods-search-v2/#search-api-v2">See the full documentation here</a>
          </div>
        </div>
        <div id="api-progress" class="list-wrapper">
          <pre>
            <code class="language-javascript">
              const endpoint= 'https://data.opendatasoft.com/api/v2/catalog/datasets/amenagements-velo-en-ile-de-france%40datailedefrance/'
              const query = 'aggregates?select=sum(longueur) as long_tot, count(*) as num_bikepath&group_by=nom_com&limit=10'
              fetch(endpoint + query)
                .then(res => res.json()) //axios.get(â€¦) would avoid that ðŸ˜‰
                .then(doSomethingWithData)
            </code>
          </pre>
          <h3>Cities with the most bikepaths in Ile-de-France:</h3>
          <ul id="top-cities-bikepath"></ul>
        </div>
      </div>
    </section>
    <section id="plugins">
      <div id="mapbox-scrollbo">
        <div id="mapbox" class="fullscreen-feature"></div>
        <div class="step" data-feature="mapbox">
          <div class="story-block lefty">
            <p>With those APIÂ call, you can fetch data and then inject them into your favorite plugins, like Mapbox GL JS.</p>
          </div>
        </div>
        <div class="step" data-feature="mapbox-fly">
          <div class="story-block righty">
            <p>Then you can trigger any callback you want when steps enter and leave. Here we use a <code>flyTo</code> method.</p>
            <p>If you feel async JS is too painful, stick to the ODS widgets, they will do the job for you ðŸ˜„</p>
          </div>
        </div>
      </div>
    </section>
    <!-- The ".step" is used as a selector for the scroller.
      Whenever it enters/leaves the screen the onStepEnter/onStepExit callback is fired
      data-feature will tell wich element to apply/remove the ".acitve" class on.-->
  </div>

  <!-- These are  the required js library if you use ODS widgets. Carefully test if you are using a framework, since they rely on AngularJS and jQuery -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.7/angular.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/angular.js/1.4.7/angular-sanitize.min.js"></script>
  <script type="text/javascript" src="https://opendatasoft.github.io/ods-widgets/dist/ods-widgets.js"></script>
</body>

</html>
